package com.retech.fangzheng;import jxl.Workbook;import jxl.write.Label;import jxl.write.WritableSheet;import jxl.write.WritableWorkbook;import java.io.File;import java.io.InputStream;import java.sql.Connection;import java.sql.DriverManager;import java.sql.ResultSet;import java.sql.Statement;import java.util.Properties;public class Main {    public static void main(String[] args) {	// write your code here        try {            InputStream input = Main.class.getClassLoader().getResourceAsStream("test.properties");            Properties prop = new Properties();            prop.load(input);            String dbStr = prop.getProperty("db.connStr");            String dbUser = prop.getProperty("db.username");            String dbPassword = prop.getProperty("db.password");            dbStr = dbStr + "user="+dbUser+";password="+dbPassword+";";            File xlsfile = new File(prop.getProperty("db.file"));            WritableWorkbook wb = Workbook.createWorkbook(xlsfile);            WritableSheet ws = wb.createSheet("person",0);            int row = 0;            ws.addCell(new Label(0,row,"系统编码"));            ws.addCell(new Label(1,row,"系统名称"));            ws.addCell(new Label(2,row,"系统英文名称"));            ws.addCell(new Label(3,row,"部门编码"));            ws.addCell(new Label(4,row,"部门名称"));            ws.addCell(new Label(5,row,"部门英文名称"));            ws.addCell(new Label(6,row,"科编码"));            ws.addCell(new Label(7,row,"科名称"));            ws.addCell(new Label(8,row,"科英文名称"));            ws.addCell(new Label(9,row,"组编码"));            ws.addCell(new Label(10,row,"组名称"));            ws.addCell(new Label(11,row,"组英文名称"));            ws.addCell(new Label(12,row,"岗位编码"));            ws.addCell(new Label(13,row,"岗位名称"));            ws.addCell(new Label(14,row,"岗位英文名称"));            ws.addCell(new Label(15,row,"岗位级别"));            ws.addCell(new Label(16,row,"员工工号"));            ws.addCell(new Label(17,row,"员工姓名"));            ws.addCell(new Label(18,row,"员工英文名"));            ws.addCell(new Label(19,row,"姓名拼音"));            ws.addCell(new Label(20,row,"公司邮箱"));            ws.addCell(new Label(21,row,"主要汇报上级工号"));            ws.addCell(new Label(22,row,"员工性别"));            ws.addCell(new Label(23,row,"出生日期"));            ws.addCell(new Label(24,row,"出生地"));            ws.addCell(new Label(25,row,"学历"));            ws.addCell(new Label(26,row,"入职时间"));            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");            Connection conn = DriverManager.getConnection(dbStr);            Statement statement = conn.createStatement();            ResultSet rs = statement.executeQuery("select * from EmpInfo_Weixin");            while (rs.next()){                row++;                ws.addCell(new Label(0,row,rs.getString("SysCode")));                ws.addCell(new Label(1,row,rs.getString("SysName")));                ws.addCell(new Label(2,row,rs.getString("SysNameEN")));                ws.addCell(new Label(3,row,rs.getString("DepCode")));                ws.addCell(new Label(4,row,rs.getString("DepName")));                ws.addCell(new Label(5,row,rs.getString("DepNameEN")));                ws.addCell(new Label(6,row,rs.getString("OffCode")));                ws.addCell(new Label(7,row,rs.getString("OffName")));                ws.addCell(new Label(8,row,rs.getString("OffNameEN")));                ws.addCell(new Label(9,row,rs.getString("GroupCode")));                ws.addCell(new Label(10,row,rs.getString("GroupName")));                ws.addCell(new Label(11,row,rs.getString("GroupNameEN")));                ws.addCell(new Label(12,row,rs.getString("PostCode")));                ws.addCell(new Label(13,row,rs.getString("PostName")));                ws.addCell(new Label(14,row,rs.getString("PostNameEN")));                ws.addCell(new Label(15,row,rs.getString("PostLevel")));                ws.addCell(new Label(16,row,rs.getString("EmployeeID")));                ws.addCell(new Label(17,row,rs.getString("EmployeeName")));                ws.addCell(new Label(18,row,rs.getString("EmployeeNameEN")));                ws.addCell(new Label(19,row,rs.getString("EmployeeNamePY")));                ws.addCell(new Label(20,row,rs.getString("Email")));                ws.addCell(new Label(21,row,rs.getString("MajorSupID")));                ws.addCell(new Label(22,row,rs.getString("Gender")));                ws.addCell(new Label(23,row,rs.getString("Birth")));  //"出生日期"));                ws.addCell(new Label(24,row,rs.getString("BirthPlace")));//"出生地"));                ws.addCell(new Label(25,row,rs.getString("Education")));//"学历"));                ws.addCell(new Label(26,row,rs.getString("InComTime")));//"入职时间"));            }            wb.write();            wb.close();//            File xlsfile = new File("D:/question.xls");//            WritableWorkbook wb = Workbook.createWorkbook(xlsfile);//            WritableSheet ws = wb.createSheet("question",0);//            int row = 0;//            ws.addCell(new Label(0,row,"序号"));//            ws.addCell(new Label(1,row,"题干及答案"));//            ws.addCell(new Label(2,row,"正确答案"));//            ws.addCell(new Label(3,row,"题型"));//            ws.addCell(new Label(4,row,"难度"));//            ws.addCell(new Label(5,row,"试题分析"));//            ws.addCell(new Label(6,row,"关键词"));//            ws.addCell(new Label(7,row,"所属分类"));////            String fullFileName = "D:/question.txt";//            File file = new File(fullFileName);//            StringBuilder buffer = new StringBuilder();//            Scanner scanner = null;//            scanner = new Scanner(file, "utf-8");//            while (scanner.hasNextLine()) {//                buffer.append(scanner.nextLine());//            }//            JSONArray array = JSONArray.fromObject(buffer.toString());////            int orderNo =1;////            for (int i = 0; i < array.size(); i++) {//                JSONObject obj = array.getJSONObject(i);//                if (obj.getInt("Status") != 0){//                    continue;//                }//                row++;//                ws.addCell(new Number(0,row,orderNo++));//                ws.addCell(new Label(1,row,obj.getString("QuestionContent")));//                ws.addCell(new Label(3,row,obj.getString("QuestionType")));//                ws.addCell(new Label(4,row,obj.getString("QuestionLevel")));//                ws.addCell(new Label(7,row,obj.getString("QuestionSortID")));//                JSONArray answers = obj.getJSONArray("QuestionAnswer");//                for (int a = 0; a < answers.size(); a++){//                    row++;//                    JSONObject aObj = answers.getJSONObject(a);//                    ws.addCell(new Label(1,row,aObj.getString("Answer")));//                    int isAnswer = aObj.getInt("AnswerFlag");//                    if (isAnswer == 1){//                        ws.addCell(new Label(2,row,"是"));//                    }//                }//            }////            wb.write();//            wb.close();        }catch (Exception e){            e.printStackTrace();        }    }}